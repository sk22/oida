<!DOCTYPE html>
<html lang="en">
  <head>
    <title>oida</title>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="style.css">
  </head>  
  <body contenteditable spellcheck="false" class="oida">
    <div>oida</div>
    <script src="https://cdn.jsdelivr.net/npm/lodash@4.17.15/lodash.min.js"></script>
    <script>
      let interval
      let colors = ["white", "red", "orange", "yellow", "green", "blue", "darkblue", "purple"]
      function oida() {
        return Array(colors.length).fill(25).map((n, i) => n * (i + 1) / 100).map(n => `${n}rem `.repeat(2)).map((x, i) => `${x}${colors[i]}`).join(', ') + ';'
      }
      console.log(colors)
      console.log(oida)
      
      function whee() {
        interval = setInterval(() => {
          colors = [ colors[0], ...colors.slice(2), colors[1] ]
          document.querySelectorAll('body > *').forEach(e => e.setAttribute('style', `text-shadow: ${oida()};`))
        }, 100)
      }
      
      const makeOida = text => {
        const el = document.createElement('div')
        el.className = 'oida'
        el.innerText = text
        return el
      }
      
      if (location.hash) {
        const text = decodeURIComponent(location.hash.slice(1))
        document.querySelectorAll('body > *').forEach(el => el.remove())
        text.split('\n').map(makeOida).forEach(el => document.body.appendChild(el))
      }
      
      const update = () => {
        setTimeout(() => history.replaceState(undefined, document.body.innerText, `#${document.body.innerText}`))
      }
      
      const throttledUpdate = _.debounce(update, 500, { trailing: true })
      
      document.body.addEventListener('keydown', throttledUpdate)
      
      let observer = new MutationObserver(throttledUpdate)
        .observe(document.body, { attributes: true, childList: true, subtree: true })
    </script>
  </body>
</html>
